(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5591f5fa"],{"0a0d":function(t,e,a){t.exports=a("e829")},"19d9":function(t,e,a){},"2f37":function(t,e,a){var i=a("63b6");i(i.S,"Date",{now:function(){return(new Date).getTime()}})},"3b10":function(t,e,a){},"49a2":function(t,e,a){"use strict";var i=a("3b10"),n=a.n(i);n.a},5766:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"chart-container"},[a("el-col",{staticClass:"toolbar1",staticStyle:{height:"50px","padding-left":"10px","padding-top":"5px"},attrs:{span:24}},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",[a("div",{staticClass:"block"},[a("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd",size:"small",align:"center","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":t.pickerOptions},model:{value:t.queryDate,callback:function(e){t.queryDate=e},expression:"queryDate"}})],1)]),a("el-form-item",[a("el-button",{attrs:{type:"primary ",size:"small",icon:"el-icon-search"},on:{click:function(e){return t.getActiveUser()}}},[t._v("查询")])],1)],1)],1),a("el-col",{staticStyle:{position:"relative"},attrs:{span:24}},[a("div",{staticStyle:{position:"absolute","z-index":"1001",top:"10px",right:"10px"}},[a("el-radio-group",{attrs:{size:"small"},on:{change:t.chooseValChart},model:{value:t.seledVal,callback:function(e){t.seledVal=e},expression:"seledVal"}},[a("el-radio-button",{attrs:{label:"login_uv"}},[t._v("登录用户")]),a("el-radio-button",{attrs:{label:"login_num"}},[t._v("登录次数")])],1)],1),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.chartLoading,expression:"chartLoading"}],staticStyle:{width:"100%",height:"500px","margin-top":"10px","z-index":"1000"},attrs:{id:"activeUserDiv"}})]),a("div",{staticStyle:{padding:"0px 10px"}},[a("el-col",{staticStyle:{"margin-top":"10px",height:"40px","line-height":"40px","background-color":"rgba(17, 146, 175, 0.18)"},attrs:{span:24}},[a("span",{staticStyle:{padding:"10px",color:"#606266"}},[t._v("详细数据"),a("i",{staticClass:"el-icon-info"})]),a("el-link",{staticStyle:{float:"right","margin-right":"10px","font-weight":"bold"},attrs:{type:"primary",underline:!1,icon:"el-icon-download"},on:{click:t.handleExport}},[t._v("\n        导出数据\n      ")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tActiveUserList,"highlight-current-row":"","header-cell-style":{"background-color":"#f2f2f2",color:"#3a8ee6","border-bottom":"1px #f2f2f2 solid"}}},[a("el-table-column",{attrs:{prop:"day",sortable:"",label:"日期",align:"center"}}),a("el-table-column",{attrs:{prop:"login_uv",sortable:"",label:"登录用户",align:"center"}}),a("el-table-column",{attrs:{prop:"login_new",sortable:"",label:"新用户登录",align:"center"}}),a("el-table-column",{attrs:{prop:"login_old",sortable:"",label:"老用户登录",align:"center"}}),a("el-table-column",{attrs:{prop:"login_num",sortable:"",label:"登录次数",align:"center"}}),a("el-table-column",{attrs:{prop:"loginNewPrec",label:"新用户占比",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{color:"#1d8ce0","font-weight":"bold"}},[t._v(t._s(null==e.row.loginNewPrec?"":e.row.loginNewPrec+"%"))])]}}])}),a("el-table-column",{attrs:{prop:"loginOldPrec",label:"老用户占比",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{color:"#1d8ce0","font-weight":"bold"}},[t._v(t._s(null==e.row.loginOldPrec?"":e.row.loginOldPrec+"%"))])]}}])})],1)],1)],1)},n=[],r=(a("7f7f"),a("0a0d")),s=a.n(r),o=a("4ec3"),l=a("313e"),c=a.n(l),u={data:function(){return{queryDate:[new Date((new Date).getTime()-6048e5),new Date((new Date).getTime()-864e5)],pickerOptions:{disabledDate:function(t){return t.getTime()>s()()},shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}}]},chartLoading:!1,tApp:"",tActiveUserList:[],seledVal:"",activeUserList:[],dataLegStr:[],dataX:[],dataY:[]}},methods:{handleExport:function(){var t=this;if(0===this.tActiveUserList.length)return this.$message({message:"表格无数据，导出异常！",type:"warning"}),!1;Promise.all([a.e("chunk-61154d27"),a.e("chunk-2d0ba6db")]).then(function(){var e=a("39a0"),i=e.exportExcel,n=["日期","登录用户","新用户登录","老用户登录","登录次数","新用户占比","老用户占比"],r=["day","login_uv","login_new","login_old","login_num","loginNewPrec","loginOldPrec"],s=t.tActiveUserList,o=t.formatJson(r,s);i(n,o,"用户活跃excel")}.bind(null,a)).catch(a.oe)},formatJson:function(t,e){return e.map(function(e){return t.map(function(t){return e[t]})})},getActiveUser:function(){var t=this;if(!this.queryDate)return this.$message({showClose:!0,message:"请选择查询日期范围！",type:"error"}),!1;if(this.queryDate[1]<this.queryDate[0])return this.$message({showClose:!0,message:"结束日期必须大于开始日期！",type:"error"}),!1;var e=(new Date(this.queryDate[1]).getTime()-new Date(this.queryDate[0]).getTime())/864e5;if(e>31)return this.$message({showClose:!0,message:"日期范围过大，不建议操作",type:"warning"}),!1;this.chartLoading=!0,Object(o["l"])({startDate:this.queryDate[0],endDate:this.queryDate[1],platFormId:this.tApp.id}).then(function(e){var a=e.businessCode,i=e.resultSet;if(t.chartLoading=!1,"unauthenticated"===a)return t.$message({message:"未授权，请联系管理员！",type:"error"}),!1;"success"!==a?t.$message({message:"活跃用户数据加载失败，请联系管理员！",type:"error"}):(t.tActiveUserList=i,t.activeUserList=i,t.seledVal="login_uv",t.CoreChart(t.seledVal))})},chooseValChart:function(t){this.seledVal=t,this.CoreChart()},CoreChart:function(){if(this.dataY=[],this.dataLegStr=[],this.dataX=[],"login_uv"===this.seledVal){this.dataLegStr=["新用户登录","老用户登录"];var t=[],e=[];for(var a in this.activeUserList)this.dataX.push(this.activeUserList[a].day),t.push(this.activeUserList[a].login_new),e.push(this.activeUserList[a].login_old);var i={name:"新用户登录",barWidth:80,type:"bar",stack:"总量",label:{normal:{show:!0}}};i["data"]=t,this.dataY.push(i),i={},i["name"]="老用户登录",i["barWidth"]=80,i["type"]="bar",i["stack"]="总量",i["label"]={normal:{show:!0}},i["data"]=e,this.dataY.push(i)}else if("login_num"===this.seledVal){this.dataLegStr=["登录次数"];var n=[];for(var r in this.activeUserList)this.dataX.push(this.activeUserList[r].day),n.push(this.activeUserList[r].login_num);i={},i["name"]="登录次数",i["barWidth"]=80,i["type"]="bar",i["stack"]="总量",i["label"]={normal:{show:!0}},i["data"]=n,this.dataY.push(i)}this.showCharts(this.dataLegStr,this.dataX,this.dataY)},showCharts:function(t,e,a){var i=this,n={border:!1,legend:{orient:"vertical",left:"center",bottom:"bottom",data:t},grid:{left:"3%",right:"5%",bottom:"10%",containLabel:!0},xAxis:{data:e,name:"日期",axisLine:{onZero:!0},splitLine:{show:!1},splitArea:{show:!1}},yAxis:{splitArea:{show:!1}},series:a,tooltip:{trigger:"axis",formatter:function(t){for(var e=t.length,a="",n=0,r="",s=0;s<e;s++){var o=t[s].name+"<br/>"+t[s].seriesName+":"+t[s].data;a+=o+"<br/>",n+=t[s].data,r=t[s].name}return"login_uv"===i.seledVal&&(a+=r+"<br/>总量:"+n),a},axisPointer:{type:"shadow"}}};this.chartColumn=c.a.init(document.getElementById("activeUserDiv")),this.chartColumn.clear(),this.chartColumn.setOption(n),window.onresize=this.chartColumn.resize}},created:function(){this.tApp=JSON.parse(sessionStorage.getItem("tApp")),this.getActiveUser()},mounted:function(){},updated:function(){}},d=u,h=(a("c697"),a("49a2"),a("2877")),p=Object(h["a"])(d,i,n,!1,null,"079a02ec",null);e["default"]=p.exports},"7f7f":function(t,e,a){var i=a("86cc").f,n=Function.prototype,r=/^\s*function ([^ (]*)/,s="name";s in n||a("9e1e")&&i(n,s,{configurable:!0,get:function(){try{return(""+this).match(r)[1]}catch(t){return""}}})},c697:function(t,e,a){"use strict";var i=a("19d9"),n=a.n(i);n.a},e829:function(t,e,a){a("2f37"),t.exports=a("584a").Date.now}}]);