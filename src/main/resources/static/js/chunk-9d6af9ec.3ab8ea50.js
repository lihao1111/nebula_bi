(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9d6af9ec"],{"0a0d":function(e,t,r){e.exports=r("e829")},"1cfa":function(e,t,r){},"2f37":function(e,t,r){var a=r("63b6");a(a.S,"Date",{now:function(){return(new Date).getTime()}})},"5d6b":function(e,t,r){var a=r("e53d").parseInt,n=r("a1ce").trim,i=r("e692"),o=/^[-+]?0[xX]/;e.exports=8!==a(i+"08")||22!==a(i+"0x16")?function(e,t){var r=n(String(e),3);return a(r,t>>>0||(o.test(r)?16:10))}:a},7445:function(e,t,r){var a=r("63b6"),n=r("5d6b");a(a.G+a.F*(parseInt!=n),{parseInt:n})},"84ed":function(e,t,r){},a1ce:function(e,t,r){var a=r("63b6"),n=r("25eb"),i=r("294c"),o=r("e692"),s="["+o+"]",l="​",d=RegExp("^"+s+s+"*"),c=RegExp(s+s+"*$"),u=function(e,t,r){var n={},s=i(function(){return!!o[e]()||l[e]()!=l}),d=n[e]=s?t(p):o[e];r&&(n[r]=d),a(a.P+a.F*s,"String",n)},p=u.trim=function(e,t){return e=String(n(e)),1&t&&(e=e.replace(d,"")),2&t&&(e=e.replace(c,"")),e};e.exports=u},ab92:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"chart-container"},[r("el-col",{staticClass:"toolbar1",staticStyle:{height:"50px","padding-left":"10px","padding-top":"5px"},attrs:{span:24}},[r("el-form",{attrs:{inline:!0}},[r("el-form-item",[r("div",{staticClass:"block"},[r("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd",size:"small",align:"center","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.queryDate,callback:function(t){e.queryDate=t},expression:"queryDate"}})],1)]),r("el-form-item",[r("el-button",{attrs:{type:"primary ",size:"small",icon:"el-icon-search"},on:{click:e.getOrderDetail}},[e._v("查询")])],1)],1)],1),r("el-col",{staticStyle:{"padding-top":"20px","padding-right":"20px"},attrs:{span:6}},[r("el-card",{staticStyle:{"background-color":"#8CC554",color:"#fff","font-weight":"bold"},attrs:{shadow:"always"}},[r("div",{attrs:{slot:"header"},slot:"header"},[r("span",[e._v("总订购：")])]),r("div",{staticStyle:{"text-align":"center","font-size":"24px",height:"50px","line-height":"50px"}},[e._v("\n        "+e._s(e._f("formaterNumber")(e.allOrderNum))+"\n      ")])])],1),r("el-col",{staticStyle:{"padding-top":"20px","padding-right":"10px","padding-left":"10px"},attrs:{span:6}},[r("el-card",{staticStyle:{"background-color":"#00A7BA",color:"#fff","font-weight":"bold"},attrs:{shadow:"always"}},[r("div",{attrs:{slot:"header"},slot:"header"},[r("span",[e._v("新用户订购:")])]),r("div",{staticStyle:{"text-align":"center","font-size":"24px",height:"50px","line-height":"50px"}},[e._v("\n        "+e._s(e._f("formaterNumber")(e.allNewOrderNum))+"\n      ")])])],1),r("el-col",{staticStyle:{"padding-top":"20px","padding-right":"10px","padding-left":"10px"},attrs:{span:6}},[r("el-card",{staticStyle:{"background-color":"#E73278",color:"#fff","font-weight":"bold"},attrs:{shadow:"always"}},[r("div",{attrs:{slot:"header"},slot:"header"},[r("span",[e._v("老用户订购:")])]),r("div",{staticStyle:{"text-align":"center","font-size":"24px",height:"50px","line-height":"50px"}},[e._v("\n        "+e._s(e._f("formaterNumber")(e.allOldOrderNum))+"\n      ")])])],1),r("el-col",{staticStyle:{"padding-top":"20px","padding-left":"20px"},attrs:{span:6}},[r("el-card",{staticStyle:{"background-color":"#FFA705",color:"#fff","font-weight":"bold"},attrs:{shadow:"always"}},[r("div",{attrs:{slot:"header"},slot:"header"},[r("span",[e._v("退订:")])]),r("div",{staticStyle:{"text-align":"center","font-size":"24px",height:"50px","line-height":"50px"}},[e._v("\n        "+e._s(e._f("formaterNumber")(e.allUnOrderNum))+"\n      ")])])],1),r("el-col",{attrs:{span:24}},[r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.chartLoading,expression:"chartLoading"}],staticStyle:{width:"100%",height:"400px"},attrs:{id:"orderAnaDiv"}})]),r("div",{staticStyle:{padding:"0px 10px"}},[r("el-col",{staticStyle:{"margin-top":"10px",height:"40px","line-height":"40px","background-color":"rgba(17, 146, 175, 0.18)"},attrs:{span:24}},[r("span",{staticStyle:{padding:"10px",color:"#606266"}},[e._v("详细数据"),r("i",{staticClass:"el-icon-info"})]),r("el-link",{staticStyle:{float:"right","margin-right":"10px","font-weight":"bold"},attrs:{type:"primary",underline:!1,icon:"el-icon-download"},on:{click:e.handleExport}},[e._v("\n        导出数据\n      ")])],1),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tOrderList,"highlight-current-row":"","header-cell-style":{"background-color":"#f2f2f2",color:"#3a8ee6","border-bottom":"1px #fafafa solid"}}},[r("el-table-column",{attrs:{prop:"day",label:"日期",align:"center"}}),r("el-table-column",{attrs:{prop:"product_id",label:"产品ID",align:"center"}}),r("el-table-column",{attrs:{prop:"product_name",label:"产品名称",align:"center"}}),r("el-table-column",{attrs:{prop:"ordered_num",label:"总订购",align:"center"}}),r("el-table-column",{attrs:{prop:"newUordered_num",label:"新用户订购",align:"center"}}),r("el-table-column",{attrs:{prop:"oldFirstUordered_num",label:"老用户首次订购",align:"center"}}),r("el-table-column",{attrs:{prop:"oldNewReUordered_num",label:"老用户再次订购",align:"center"}}),r("el-table-column",{attrs:{prop:"unSubscribed_num",label:"退订发起",align:"center"}})],1)],1)],1)},n=[],i=r("e814"),o=r.n(i),s=r("0a0d"),l=r.n(s),d=r("4ec3"),c=r("313e"),u=r.n(c),p={data:function(){return{queryDate:[new Date((new Date).getTime()-6048e5),new Date((new Date).getTime()-864e5)],pickerOptions:{disabledDate:function(e){return e.getTime()>l()()},shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,r=new Date;r.setTime(r.getTime()-6048e5),e.$emit("pick",[r,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,r=new Date;r.setTime(r.getTime()-2592e6),e.$emit("pick",[r,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,r=new Date;r.setTime(r.getTime()-7776e6),e.$emit("pick",[r,t])}}]},chartLoading:!1,allOrderNum:0,allNewOrderNum:0,allOldOrderNum:0,allUnOrderNum:0,tApp:"",orderList:[],tOrderList:[],chooseType:""}},methods:{handleExport:function(){var e=this;if(0===this.tOrderList.length)return this.$message({message:"表格无数据，导出异常！",type:"warning"}),!1;Promise.all([r.e("chunk-61154d27"),r.e("chunk-0156a942")]).then(function(){var t=r("39a0"),a=t.exportExcel,n=["产品名称"].concat(e.tableCols),i=["display_name"].concat(e.tableCols),o=e.tOrderList,s=e.formatJson(i,o);a(n,s,"订购/退订excel")}.bind(null,r)).catch(r.oe)},formatJson:function(e,t){return t.map(function(t){return e.map(function(e){return t[e]})})},chooseTypeVal:function(e){this.chooseType=e,this.getOrderDetail()},getOrderDetail:function(){var e=this;return this.queryDate?this.queryDate[1]<this.queryDate[0]?(this.$message({showClose:!0,message:"结束日期必须大于开始日期！",type:"error"}),!1):(this.chartLoading=!0,void Object(d["C"])({startDate:this.queryDate[0],endDate:this.queryDate[1],platFormId:this.tApp.id,chooseType:this.chooseType}).then(function(t){var r=t.businessCode,a=t.resultSet;if(e.chartLoading=!1,"unauthenticated"===r)return e.$message({message:"未授权，请联系管理员！",type:"error"}),!1;"success"!==r?e.$message({message:"订购/退订数据加载失败，请联系管理员！",type:"error"}):(e.tOrderList=a,e.orderList=[],e.tOrderList.forEach(function(t){e.allOrderNum+=o()(t.ordered_num),e.allNewOrderNum+=o()(t.newUordered_num),e.allOldOrderNum+=o()(t.oldNewReUordered_num),e.allOldOrderNum+=o()(t.oldFirstUordered_num),e.allUnOrderNum+=o()(t.unSubscribed_num);var r=null;e.orderList.forEach(function(e){if(t.day===e.day)return r=e,!1}),r?(r["ordered_num"]+=o()(t["ordered_num"]),r["newUordered_num"]+=o()(t["newUordered_num"]),r["oldNewReUordered_num"]+=o()(t["oldNewReUordered_num"]),r["oldFirstUordered_num"]+=o()(t["oldFirstUordered_num"]),r["unSubscribed_num"]+=o()(t["unSubscribed_num"])):e.orderList.push(t)}),e.drawOrderChart())})):(this.$message({showClose:!0,message:"请选择查询日期范围！",type:"error"}),!1)},drawOrderChart:function(){var e=[],t=[],r=[],a=[],n=[];for(var i in this.orderList){n.push(this.orderList[i]["day"]);var o=this.orderList[i]["newUordered_num"];e.push(o);var s=this.orderList[i]["oldFirstUordered_num"];t.push(s);var l=this.orderList[i]["oldNewReUordered_num"];r.push(l);var d=0-this.orderList[i]["unSubscribed_num"];a.push(d)}var c={border:!1,legend:{orient:"vertical",left:"center",bottom:"bottom",data:["新用户订购","老用户首次订购","老用户再次订购","退订"]},grid:{left:"3%",right:"5%",bottom:"10%",containLabel:!0},xAxis:{data:n,name:"日期",silent:!1,axisLine:{onZero:!0},splitLine:{show:!1},splitArea:{show:!1}},yAxis:{splitArea:{show:!1}},series:[{name:"新用户订购",type:"bar",stack:"总量",barMaxWidth:60,label:{normal:{show:!0}},data:e},{name:"老用户首次订购",type:"bar",stack:"总量",barMaxWidth:80,label:{normal:{show:!0}},data:t},{name:"老用户再次订购",type:"bar",stack:"总量",barMaxWidth:80,label:{normal:{show:!0}},data:r},{name:"退订",type:"bar",stack:"总量",barMaxWidth:80,label:{normal:{show:!0}},data:a}],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}}};this.chartColumn=u.a.init(document.getElementById("orderAnaDiv")),this.chartColumn.clear(),this.chartColumn.setOption(c),window.onresize=this.chartColumn.resize}},created:function(){this.tApp=JSON.parse(sessionStorage.getItem("tApp")),this.chooseType="day",this.getOrderDetail()},mounted:function(){},updated:function(){}},h=p,m=(r("f4c1"),r("daa4"),r("2877")),f=Object(m["a"])(h,a,n,!1,null,"d65607be",null);t["default"]=f.exports},b9e9:function(e,t,r){r("7445"),e.exports=r("584a").parseInt},daa4:function(e,t,r){"use strict";var a=r("84ed"),n=r.n(a);n.a},e692:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},e814:function(e,t,r){e.exports=r("b9e9")},e829:function(e,t,r){r("2f37"),e.exports=r("584a").Date.now},f4c1:function(e,t,r){"use strict";var a=r("1cfa"),n=r.n(a);n.a}}]);