(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0f59ade9"],{"0a0d":function(t,e,i){t.exports=i("e829")},"2c1a":function(t,e,i){"use strict";var a=i("565e"),n=i.n(a);n.a},"2c8a":function(t,e,i){},"2f37":function(t,e,i){var a=i("63b6");a(a.S,"Date",{now:function(){return(new Date).getTime()}})},"4f34":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"chart-container"},[i("el-col",{staticClass:"toolbar1",staticStyle:{height:"50px","padding-left":"10px","padding-top":"5px"},attrs:{span:24}},[i("el-form",{attrs:{inline:!0}},[i("el-form-item",[i("div",{staticClass:"block"},[i("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd",size:"small",align:"center","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":t.pickerOptions},model:{value:t.queryDate,callback:function(e){t.queryDate=e},expression:"queryDate"}})],1)]),i("el-form-item",[i("el-button",{attrs:{type:"primary ",size:"small",icon:"el-icon-search"},on:{click:t.getPlayTime}},[t._v("查询")])],1)],1)],1),i("el-col",{attrs:{span:24}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.chartLoading,expression:"chartLoading"}],staticStyle:{width:"100%",height:"550px"},attrs:{id:"playTimeDiv"}})]),i("div",{staticStyle:{padding:"0px 10px"}},[i("el-col",{staticStyle:{"margin-top":"10px",height:"40px","line-height":"40px","background-color":"rgba(17, 146, 175, 0.18)"},attrs:{span:24}},[i("span",{staticStyle:{padding:"10px",color:"#606266"}},[t._v("详细数据"),i("i",{staticClass:"el-icon-info"})]),i("el-link",{staticStyle:{float:"right","margin-right":"10px","font-weight":"bold"},attrs:{type:"primary",underline:!1,icon:"el-icon-download"},on:{click:t.handleExport}},[t._v("\n        导出数据\n      ")])],1),i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.playTimeList,"highlight-current-row":"","header-cell-style":{"background-color":"#f2f2f2",color:"#3a8ee6","border-bottom":"1px #f2f2f2 solid"}}},[i("el-table-column",{attrs:{prop:"day",sortable:"",label:"日期",align:"left"}}),i("el-table-column",{attrs:{prop:"avgtime",sortable:"",label:"平均时长",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticStyle:{color:"#1d8ce0","font-weight":"bold"}},[t._v(t._s(null==e.row.avgtime?"":e.row.avgtime+"分钟"))])]}}])}),i("el-table-column",{attrs:{prop:"tim0_1",label:"1分钟以下",align:"left"}}),i("el-table-column",{attrs:{prop:"tim1_3",label:"1-3分钟",align:"left"}}),i("el-table-column",{attrs:{prop:"tim3_10",label:"4-10分钟",align:"left"}}),i("el-table-column",{attrs:{prop:"tim10_30",label:"11-30分钟",align:"left"}}),i("el-table-column",{attrs:{prop:"tim30_60",label:"31-60分钟",align:"left"}}),i("el-table-column",{attrs:{prop:"tim60_120",label:"60-120分钟",align:"left"}}),i("el-table-column",{attrs:{prop:"tim120",label:"120分钟以上",align:"left"}})],1)],1)],1)},n=[],s=i("0a0d"),r=i.n(s),l=i("4ec3"),o=i("313e"),p=i.n(o),c={data:function(){return{queryDate:[new Date((new Date).getTime()-6048e5),new Date((new Date).getTime()-864e5)],pickerOptions:{disabledDate:function(t){return t.getTime()>r()()},shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,i=new Date;i.setTime(i.getTime()-6048e5),t.$emit("pick",[i,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,i=new Date;i.setTime(i.getTime()-2592e6),t.$emit("pick",[i,e])}}]},chartLoading:!1,tApp:"",playTimeList:[],dataX:[],dataLegStr:[]}},methods:{valFormatter:function(t,e,i){return i+"分钟"},getPlayTime:function(){var t=this;if(!this.queryDate)return this.$message({showClose:!0,message:"请选择查询日期范围！",type:"warning"}),!1;if(this.queryDate[1]<this.queryDate[0])return this.$message({showClose:!0,message:"结束日期必须大于开始日期！",type:"error"}),!1;var e=(new Date(this.queryDate[1]).getTime()-new Date(this.queryDate[0]).getTime())/864e5;if(e>31)return this.$message({showClose:!0,message:"日期范围过大，不建议操作",type:"warning"}),!1;this.chartLoading=!0,Object(l["J"])({startDate:this.queryDate[0],endDate:this.queryDate[1],platFormId:this.tApp.id}).then(function(e){var i=e.businessCode,a=e.resultSet;if(t.chartLoading=!1,"unauthenticated"===i)return t.$message({message:"未授权，请联系管理员！",type:"error"}),!1;if("success"!==i)t.$message({message:"有效播放数据加载失败，请联系管理员！",type:"error"});else{if(t.playTimeList=a,null==t.playTimeList||0===t.playTimeList.length)return t.$notify.info({title:"警告",message:"未加载到用户播放数据！",type:"warning"}),!1;t.drawPlayTimeChart()}})},drawPlayTimeChart:function(){this.dataLegStr=["1分钟以下","1-3分钟","3-10分钟","11-30分钟","31-60分钟","61-120分钟","121分钟以上"];var t=["itemInterval"],e=["1分钟以下"],i=["1-3分钟]"],a=["3-10分钟"],n=["11-30分钟"],s=["31-60分钟"],r=["61-120分钟"],l=["121分钟以上"],o="";for(var c in this.playTimeList){var m=this.playTimeList[c].day;""===o&&(o=m),-1===t.indexOf(m)&&t.push(m),e.push(this.playTimeList[c].tim0_1),i.push(this.playTimeList[c].tim1_3),a.push(this.playTimeList[c].tim3_10),n.push(this.playTimeList[c].tim10_30),s.push(this.playTimeList[c].tim30_60),r.push(this.playTimeList[c].tim60_120),l.push(this.playTimeList[c].tim120)}this.dataX=t;var u={border:!1,legend:{orient:"vertical",x:"right",y:"top",padding:10,data:this.dataLegStr},tooltip:{trigger:"axis",showContent:!1},dataset:{source:[t,e,i,a,n,s,r,l]},grid:{top:"55%",left:"3%",right:"5%",bottom:"5%",containLabel:!0},xAxis:{type:"category"},yAxis:{gridIndex:0},series:[{type:"line",smooth:!0,seriesLayoutBy:"row"},{type:"line",smooth:!0,seriesLayoutBy:"row"},{type:"line",smooth:!0,seriesLayoutBy:"row"},{type:"line",smooth:!0,seriesLayoutBy:"row"},{type:"line",smooth:!0,seriesLayoutBy:"row"},{type:"line",smooth:!0,seriesLayoutBy:"row"},{type:"line",smooth:!0,seriesLayoutBy:"row"},{type:"pie",id:"pie",radius:"40%",center:["50%","25%"],label:{formatter:"{b}: {@"+o+"} ({d}%)"},encode:{itemName:"itemInterval",value:o,tooltip:o}}]},d=p.a.init(document.getElementById("playTimeDiv"));setTimeout(function(){d.on("updateAxisPointer",function(t){var e=t.axesInfo[0];if(e){var i=e.value+1;d.setOption({series:{id:"pie",label:{formatter:"{b}: {@["+i+"]} ({d}%)"},encode:{value:i,tooltip:i}}})}})},10),d.setOption(u),window.onresize=d.resize},handleExport:function(){var t=this;if(0===this.playTimeList.length)return this.$message({message:"表格无数据，导出异常！",type:"warning"}),!1;Promise.all([i.e("chunk-61154d27"),i.e("chunk-0156a942")]).then(function(){var e=i("39a0"),a=e.exportExcel,n=["日期","平均时长","1分钟以下（人数）","1-3分钟（人数）","4-10分钟（人数）","11-30分钟（人数）","31-60分钟（人数）","61-120分钟（人数）","121分钟以上（人数）"],s=["day","avgtime","tim0_1","tim1_3","tim3_10","tim10_30","tim30_60","tim60_120","tim120"],r=t.playTimeList,l=t.formatJson(s,r);a(n,l,"列表excel")}.bind(null,i)).catch(i.oe)}},created:function(){this.tApp=JSON.parse(sessionStorage.getItem("tApp")),this.getPlayTime()},mounted:function(){},updated:function(){}},m=c,u=(i("ad78"),i("2c1a"),i("2877")),d=Object(u["a"])(m,a,n,!1,null,"7ff3f0c7",null);e["default"]=d.exports},"565e":function(t,e,i){},ad78:function(t,e,i){"use strict";var a=i("2c8a"),n=i.n(a);n.a},e829:function(t,e,i){i("2f37"),t.exports=i("584a").Date.now}}]);