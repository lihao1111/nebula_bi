(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-77477554"],{"0a0d":function(e,t,i){e.exports=i("e829")},"2f37":function(e,t,i){var a=i("63b6");a(a.S,"Date",{now:function(){return(new Date).getTime()}})},"7acc":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("section",{staticClass:"chart-container"},[i("el-col",{staticClass:"toolbar1",staticStyle:{height:"50px","padding-left":"10px","padding-top":"5px"},attrs:{span:24}},[i("el-form",{attrs:{inline:!0}},[i("el-form-item",[i("div",{staticClass:"block"},[i("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd",size:"small",align:"center","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.queryDate,callback:function(t){e.queryDate=t},expression:"queryDate"}})],1)]),i("el-form-item",[i("el-button",{attrs:{type:"primary ",size:"small",icon:"el-icon-search"},on:{click:e.getUseTime}},[e._v("查询")])],1)],1)],1),i("el-col",{attrs:{span:24}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.chartLoading,expression:"chartLoading"}],staticStyle:{width:"100%",height:"550px"},attrs:{id:"useTimeDiv"}})]),i("div",{staticStyle:{padding:"0px 10px"}},[i("el-col",{staticStyle:{"margin-top":"10px",height:"40px","line-height":"40px","background-color":"rgba(17, 146, 175, 0.18)"},attrs:{span:24}},[i("span",{staticStyle:{padding:"10px",color:"#606266"}},[e._v("详细数据"),i("i",{staticClass:"el-icon-info"})]),i("el-link",{staticStyle:{float:"right","margin-right":"10px","font-weight":"bold"},attrs:{type:"primary",underline:!1,icon:"el-icon-download"},on:{click:e.handleExport}},[e._v("\n        导出数据\n      ")])],1),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.useTimeList,"highlight-current-row":"","header-cell-style":{"background-color":"#f2f2f2",color:"#3a8ee6","border-bottom":"1px #f2f2f2 solid"}}},[i("el-table-column",{attrs:{prop:"day",sortable:"",label:"日期",align:"left"}}),i("el-table-column",{attrs:{prop:"avgtime",sortable:"",label:"平均时长",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticStyle:{color:"#1d8ce0","font-weight":"bold"}},[e._v(e._s(null==t.row.avgtime?"":t.row.avgtime+"分钟"))])]}}])}),i("el-table-column",{attrs:{prop:"tim0_1",label:"1分钟以下",align:"left"}}),i("el-table-column",{attrs:{prop:"tim1_3",label:"1-3分钟",align:"left"}}),i("el-table-column",{attrs:{prop:"tim3_10",label:"4-10分钟",align:"left"}}),i("el-table-column",{attrs:{prop:"tim10_30",label:"11-30分钟",align:"left"}}),i("el-table-column",{attrs:{prop:"tim30_60",label:"31-60分钟",align:"left"}}),i("el-table-column",{attrs:{prop:"tim60_120",label:"60-120分钟",align:"left"}}),i("el-table-column",{attrs:{prop:"tim120",label:"120分钟以上",align:"left"}})],1)],1)],1)},s=[],n=i("0a0d"),r=i.n(n),o=i("4ec3"),l=i("313e"),c=i.n(l),u={data:function(){return{queryDate:[new Date((new Date).getTime()-6048e5),new Date((new Date).getTime()-864e5)],pickerOptions:{disabledDate:function(e){return e.getTime()>r()()},shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-6048e5),e.$emit("pick",[i,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-2592e6),e.$emit("pick",[i,t])}}]},chartLoading:!1,tApp:"",useTimeList:[],dataX:[],dataLegStr:[]}},methods:{valFormatter:function(e,t,i){return i+"分钟"},getUseTime:function(){var e=this;if(!this.queryDate)return this.$message({showClose:!0,message:"请选择查询日期范围！",type:"warning"}),!1;if(this.queryDate[1]<this.queryDate[0])return this.$message({showClose:!0,message:"结束日期必须大于开始日期！",type:"error"}),!1;var t=(new Date(this.queryDate[1]).getTime()-new Date(this.queryDate[0]).getTime())/864e5;if(t>31)return this.$message({showClose:!0,message:"日期范围过大，不建议操作",type:"warning"}),!1;this.chartLoading=!0,Object(o["O"])({startDate:this.queryDate[0],endDate:this.queryDate[1],platFormId:this.tApp.id}).then(function(t){var i=t.businessCode,a=t.resultSet;if(e.chartLoading=!1,"unauthenticated"===i)return e.$message({message:"未授权，请联系管理员！",type:"error"}),!1;"success"!==i?e.$message({message:"在线时长加载失败，请联系管理员！",type:"error"}):(e.useTimeList=a,e.drawUseTimeChart())})},drawUseTimeChart:function(){this.dataLegStr=["1分钟以下","1-3分钟","3-10分钟","11-30分钟","31-60分钟","61-120分钟","121分钟以上"];var e=["itemInterval"],t=["1分钟以下"],i=["1-3分钟]"],a=["3-10分钟"],s=["11-30分钟"],n=["31-60分钟"],r=["61-120分钟"],o=["121分钟以上"],l="";for(var u in this.useTimeList){var m=this.useTimeList[u].day;""===l&&(l=m),-1===e.indexOf(m)&&e.push(m),t.push(this.useTimeList[u].tim0_1),i.push(this.useTimeList[u].tim1_3),a.push(this.useTimeList[u].tim3_10),s.push(this.useTimeList[u].tim10_30),n.push(this.useTimeList[u].tim30_60),r.push(this.useTimeList[u].tim60_120),o.push(this.useTimeList[u].tim120)}this.dataX=e;var p={border:!1,legend:{orient:"vertical",x:"right",y:"top",padding:10,data:this.dataLegStr},tooltip:{trigger:"axis",showContent:!1},dataset:{source:[e,t,i,a,s,n,r,o]},grid:{top:"55%",left:"3%",right:"5%",bottom:"5%",containLabel:!0},xAxis:{type:"category"},yAxis:{gridIndex:0},series:[{type:"line",smooth:!0,seriesLayoutBy:"row"},{type:"line",smooth:!0,seriesLayoutBy:"row"},{type:"line",smooth:!0,seriesLayoutBy:"row"},{type:"line",smooth:!0,seriesLayoutBy:"row"},{type:"line",smooth:!0,seriesLayoutBy:"row"},{type:"line",smooth:!0,seriesLayoutBy:"row"},{type:"line",smooth:!0,seriesLayoutBy:"row"},{type:"pie",id:"pie",radius:"40%",center:["50%","25%"],label:{formatter:"{b}: {@"+l+"} ({d}%)"},encode:{itemName:"itemInterval",value:l,tooltip:l}}]},d=c.a.init(document.getElementById("useTimeDiv"));setTimeout(function(){d.on("updateAxisPointer",function(e){var t=e.axesInfo[0];if(t){var i=t.value+1;d.setOption({series:{id:"pie",label:{formatter:"{b}: {@["+i+"]} ({d}%)"},encode:{value:i,tooltip:i}}})}})},0),d.setOption(p),window.onresize=d.resize},handleExport:function(){var e=this;if(0===this.useTimeList.length)return this.$message({message:"表格无数据，导出异常！",type:"warning"}),!1;Promise.all([i.e("chunk-61154d27"),i.e("chunk-0156a942")]).then(function(){var t=i("39a0"),a=t.exportExcel,s=["日期","平均时长","1分钟以下（人数）","1-3分钟（人数）","4-10分钟（人数）","11-30分钟（人数）","31-60分钟（人数）","61-120分钟（人数）","121分钟以上（人数）"],n=["day","avgtime","tim0_1","tim1_3","tim3_10","tim10_30","tim30_60","tim60_120","tim120"],r=e.useTimeList,o=e.formatJson(n,r);a(s,o,"列表excel")}.bind(null,i)).catch(i.oe)}},created:function(){this.tApp=JSON.parse(sessionStorage.getItem("tApp")),this.getUseTime()},mounted:function(){},updated:function(){}},m=u,p=(i("fa8b"),i("fa27"),i("2877")),d=Object(p["a"])(m,a,s,!1,null,"31311f5c",null);t["default"]=d.exports},af28:function(e,t,i){},c15a:function(e,t,i){},e829:function(e,t,i){i("2f37"),e.exports=i("584a").Date.now},fa27:function(e,t,i){"use strict";var a=i("c15a"),s=i.n(a);s.a},fa8b:function(e,t,i){"use strict";var a=i("af28"),s=i.n(a);s.a}}]);