(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3219a6c3"],{"16ca":function(t,e,a){"use strict";var i=a("a681"),o=a.n(i);o.a},5902:function(t,e,a){"use strict";var i=a("a71f"),o=a.n(i);o.a},"7f7f":function(t,e,a){var i=a("86cc").f,o=Function.prototype,s=/^\s*function ([^ (]*)/,r="name";r in o||a("9e1e")&&i(o,r,{configurable:!0,get:function(){try{return(""+this).match(s)[1]}catch(t){return""}}})},a681:function(t,e,a){},a71f:function(t,e,a){},c87f:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"chart-container"},[a("el-col",{staticClass:"toolbar1",staticStyle:{height:"50px","padding-left":"10px","padding-top":"5px"},attrs:{span:24}},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"页面："}},[a("el-select",{attrs:{size:"small",clearable:"",placeholder:"请选择页面","value-key":"page_id"},on:{change:t.choosePage},model:{value:t.choosePageId,callback:function(e){t.choosePageId=e},expression:"choosePageId"}},t._l(t.pages,function(t){return a("el-option",{key:t.page_id,attrs:{value:t.page_id,label:t.name}})}),1)],1),a("el-form-item",{attrs:{label:"日期："}},[a("div",{staticClass:"block"},[a("el-date-picker",{attrs:{size:"small",type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.queryDate,callback:function(e){t.queryDate=e},expression:"queryDate"}})],1)]),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:t.getPromotionList}},[t._v("查询")])],1)],1)],1),a("div",{staticStyle:{"z-index":"-1"}},[a("el-col",{staticStyle:{"margin-top":"10px"},attrs:{span:14}},[a("el-image",{staticStyle:{width:"100%",height:"400px"},attrs:{src:t.pageUrl}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[a("i",{staticClass:"el-icon-picture-outline"},[t._v("页面图片")])])])],1),a("el-col",{staticStyle:{position:"relative","margin-top":"10px"},attrs:{span:10}},[a("div",{staticStyle:{position:"absolute","z-index":"1001",right:"10px"}},[a("el-radio-group",{attrs:{size:"small"},on:{change:t.chooseValChart},model:{value:t.seledVal,callback:function(e){t.seledVal=e},expression:"seledVal"}},[a("el-radio-button",{attrs:{label:"page_pv"}},[t._v("点击量")]),a("el-radio-button",{attrs:{label:"page_uv"}},[t._v("独立访问")])],1)],1),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.chartLoading,expression:"chartLoading"}],staticStyle:{width:"100%",height:"400px","z-index":"1000"},attrs:{id:"promotionPerDiv"}},[0==this.promotionList.length?a("i",{staticClass:"el-icon-picture-outline"},[t._v("图表")]):t._e()])])],1),a("div",{staticStyle:{padding:"0px 10px"}},[a("el-col",{staticStyle:{"margin-top":"10px",height:"40px","line-height":"40px","background-color":"rgba(17, 146, 175, 0.18)"},attrs:{span:24}},[a("span",{staticStyle:{padding:"10px",color:"#606266"}},[t._v("详细数据"),a("i",{staticClass:"el-icon-info"})]),a("el-link",{staticStyle:{float:"right","margin-right":"10px","font-weight":"bold"},attrs:{type:"primary",underline:!1,icon:"el-icon-download"},on:{click:t.handleExport}},[t._v("\n        导出数据\n      ")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.promotionList,"highlight-current-row":"","header-cell-style":{"background-color":"#f2f2f2",color:"#3a8ee6","border-bottom":"1px #f2f2f2 solid"}}},[a("el-table-column",{attrs:{prop:"day",label:"日期",align:"center"}}),a("el-table-column",{attrs:{prop:"description",label:"推荐位描述",align:"center"}}),a("el-table-column",{attrs:{prop:"title",label:"推荐位名称",align:"center"}}),a("el-table-column",{attrs:{prop:"name",label:"所属页面",align:"center"}}),a("el-table-column",{attrs:{prop:"pv",label:"点击量",align:"center"}}),a("el-table-column",{attrs:{prop:"uv",label:"独立访问量",align:"center"}})],1)],1)],1)},o=[],s=(a("7f7f"),a("4ec3")),r=a("313e"),n=a.n(r),l={data:function(){return{queryDate:new Date((new Date).getTime()-864e5),chartLoading:!1,tApp:"",pages:[],choosePageId:"",seledVal:"",pageUrl:"",promotionList:[],dataLegStr:[],dataSer:[]}},methods:{handleExport:function(){var t=this;if(0===this.subjectList.length)return this.$message({message:"表格无数据，导出异常！",type:"warning"}),!1;Promise.all([a.e("chunk-61154d27"),a.e("chunk-2d0ba6db")]).then(function(){var e=a("39a0"),i=e.exportExcel,o=["日期","推荐位描述","推荐位名称","所属页面","点击量","独立访问量"],s=["day","description","title","name","pv","uv"],r=t.subjectList,n=t.formatJson(s,r);i(o,n,"页面热点excel")}.bind(null,a)).catch(a.oe)},formatJson:function(t,e){return e.map(function(e){return t.map(function(t){return e[t]})})},chooseValChart:function(t){this.seledVal=t,this.drawPromotionChart()},choosePage:function(t){this.pages.forEach(function(e){if(t===e.page_id)return e,!1}),this.choosePageId&&(this.pageUrl="http://img.wanyx.com/softImg/soft/1650_s.jpg",this.getPromotionList())},getPages:function(){var t=this;Object(s["G"])({platFormId:this.tApp.id}).then(function(e){var a=e.businessCode,i=e.resultSet;"success"!==a?t.$message({message:"页面数据加载失败，请联系管理员！",type:"error"}):t.pages=i})},getPromotionList:function(){var t=this;return this.queryDate?this.choosePageId?(this.chartLoading=!0,void Object(s["K"])({queryDate:this.queryDate,pageId:this.choosePageId,platFormId:this.tApp.id}).then(function(e){var a=e.businessCode,i=e.resultSet;if(t.chartLoading=!1,"unauthenticated"===a)return t.$message({message:"未授权，请联系管理员！",type:"error"}),!1;"success"!==a?t.$message({message:"页面热点数据加载失败，请联系管理员！",type:"error"}):(t.promotionList=i,t.seledVal="page_pv",t.drawPromotionChart())})):(this.$message({showClose:!0,message:"请选择页面查询！",type:"error"}),!1):(this.$message({showClose:!0,message:"请选择查询日期！",type:"error"}),!1)},drawPromotionChart:function(){var t=this;this.dataLegStr=[],this.dataSer=[];var e="",a={};this.promotionList.forEach(function(i){t.dataLegStr.push(i.title),"page_pv"===t.seledVal?(e="点击量",a={},a["name"]=i.title,a["value"]=i.pv,t.dataSer.push(a)):"page_uv"===t.seledVal&&(e="独立访问",a={},a["name"]=i.title,a["value"]=i.uv,t.dataSer.push(a))});var i={tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",x:"left",data:this.dataLegStr},series:[{name:e,type:"pie",radius:["50%","70%"],center:["60%","60%"],label:{normal:{show:!1,position:"center"},emphasis:{show:!0,textStyle:{fontSize:"30",fontWeight:"bold"}}},labelLine:{normal:{show:!1}},data:this.dataSer}]};this.chartColumn=n.a.init(document.getElementById("promotionPerDiv")),this.chartColumn.clear(),this.chartColumn.setOption(i),window.onresize=this.chartColumn.resize}},created:function(){this.tApp=JSON.parse(sessionStorage.getItem("tApp")),this.getPages()},mounted:function(){},updated:function(){}},c=l,p=(a("16ca"),a("5902"),a("2877")),d=Object(p["a"])(c,i,o,!1,null,"dd89e1ba",null);e["default"]=d.exports}}]);