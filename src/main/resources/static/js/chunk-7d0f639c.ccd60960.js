(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7d0f639c"],{"0cb2":function(t,e,a){"use strict";var s=a("1ec5"),r=a.n(s);r.a},"1ec5":function(t,e,a){},"525c":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"chart-container"},[a("el-col",{staticClass:"toolbar1",staticStyle:{height:"50px","padding-left":"10px","padding-top":"5px"},attrs:{span:24}},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",[a("div",{staticClass:"block"},[a("el-date-picker",{attrs:{size:"small",type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.queryDate,callback:function(e){t.queryDate=e},expression:"queryDate"}})],1)]),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:t.getPVUVList}},[t._v("查询")])],1),a("el-form-item",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:t.addCompare}},[t._v("对比日期")])],1)],1)],1),a("div",[a("el-col",{staticStyle:{"padding-top":"20px","padding-right":"20px"},attrs:{span:8}},[a("el-card",{staticStyle:{"background-color":"#8CC554",color:"#fff","font-weight":"bold"},attrs:{shadow:"always"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[t._v("日期："+t._s(this.moment(this.queryDate).format("YYYY-MM-DD")))])]),a("div",{staticStyle:{"text-align":"center","font-size":"24px",height:"50px","line-height":"50px"}},[t._v("\n                PV："+t._s(t._f("formaterNumber")(t.sumPV))+"\n            ")])])],1),a("el-col",{staticStyle:{"padding-top":"20px","padding-right":"10px","padding-left":"10px"},attrs:{span:8}},[a("el-card",{staticStyle:{"background-color":"#00A7BA",color:"#fff","font-weight":"bold"},attrs:{shadow:"always"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[t._v("日期："+t._s(this.moment(this.queryDate).format("YYYY-MM-DD")))])]),a("div",{staticStyle:{"text-align":"center","font-size":"24px",height:"50px","line-height":"50px"}},[t._v("\n                UV："+t._s(t._f("formaterNumber")(t.sumUV))+"\n            ")])])],1),a("el-col",{staticStyle:{"padding-top":"20px","padding-left":"20px"},attrs:{span:8}},[a("el-card",{staticStyle:{"background-color":"#E73278",color:"#fff","font-weight":"bold"},attrs:{shadow:"always"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[t._v("日期："+t._s(this.moment(this.queryDate).format("YYYY-MM-DD")))])]),a("div",{staticStyle:{"text-align":"center","font-size":"24px",height:"50px","line-height":"50px"}},[t._v("\n                PV/UV："+t._s(t.sumPVUVPer.toFixed(2))+"\n            ")])])],1)],1),a("el-col",{attrs:{span:24}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.chartLoading,expression:"chartLoading"}],staticStyle:{width:"100%",height:"400px"},attrs:{id:"onlinePVUVDiv"}})]),a("div",{staticStyle:{padding:"0px 10px"}},[a("el-col",{staticStyle:{"margin-top":"10px",height:"40px","line-height":"40px","background-color":"rgba(17, 146, 175, 0.18)"},attrs:{span:24}},[a("span",{staticStyle:{padding:"10px",color:"#606266"}},[t._v("详细数据"),a("i",{staticClass:"el-icon-info"})]),a("el-link",{staticStyle:{float:"right","margin-right":"10px","font-weight":"bold"},attrs:{type:"primary",underline:!1,icon:"el-icon-download"},on:{click:t.handleExport}},[t._v("\n        导出数据\n      ")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.pvuvList,"highlight-current-row":"","header-cell-style":{"background-color":"#f2f2f2",color:"#3a8ee6","border-bottom":"1px #f2f2f2 solid"}}},[a("el-table-column",{attrs:{prop:"day",label:"日期",align:"center"}}),a("el-table-column",{attrs:{prop:"hour",label:"小时",align:"center"}}),a("el-table-column",{attrs:{prop:"pv",sortable:"",label:"PV",align:"center"}}),a("el-table-column",{attrs:{prop:"uv",sortable:"",label:"UV",align:"center"}}),a("el-table-column",{attrs:{prop:"PVUVPrec",sortable:"",label:"UV/PV占比",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{color:"#1d8ce0","font-weight":"bold"}},[t._v(t._s(null==e.row.PVUVPrec?"":e.row.PVUVPrec+"%"))])]}}])})],1)],1),a("el-dialog",{attrs:{title:"选择",visible:t.compareForm,"close-on-click-modal":!1,width:"30%"},on:{"update:visible":function(e){t.compareForm=e}}},[a("div",{staticStyle:{"padding-left":"60px"}},[a("span",{staticStyle:{"font-size":"16px","font-weight":"bold","margin-right":"10px"}},[t._v("对比日期")]),a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.compareDate,callback:function(e){t.compareDate=e},expression:"compareDate"}})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){t.compareForm=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.compareSubmit()}}},[t._v("提交")])],1)])],1)},r=[],i=(a("28a5"),a("4ec3")),o=a("313e"),n=a.n(o),l={data:function(){return{chartLoading:!1,queryDate:new Date,tApp:"",sumPV:0,sumUV:0,sumPVUVPer:0,pvuvList:[],compareDate:new Date((new Date).getTime()-864e5),compareForm:!1,compareList:[],drawChartDatas:[],dataLegStr:[],dataX:[],dataYSer:[],dataY:{}}},methods:{getPVUVList:function(){var t=this;if(!this.queryDate)return this.$message({showClose:!0,message:"请选择查询日期！",type:"error"}),!1;this.chartLoading=!0,Object(i["E"])({queryDate:this.queryDate,platFormId:this.tApp.id}).then(function(e){var a=e.businessCode,s=e.resultSet;if(t.chartLoading=!1,"unauthenticated"===a)return t.$message({message:"未授权，请联系管理员！",type:"error"}),!1;"success"!==a?t.$message({message:"PVUV数据加载失败，请联系管理员！",type:"error"}):(t.pvuvList=s,t.getPVUVSum(),t.queryPVUVChart())})},getPVUVSum:function(){var t=this;if(!this.queryDate)return this.$message({showClose:!0,message:"请选择查询日期！",type:"error"}),!1;Object(i["F"])({queryDate:this.queryDate,platFormId:this.tApp.id}).then(function(e){var a=e.businessCode,s=e.resultSet;"success"!==a?t.$message({message:"PVUV汇总数据加载失败，请联系管理员！",type:"error"}):(t.sumUV=0,t.sumPV=0,t.sumPVUVPer=0,null!=s&&s.length>0&&(t.sumUV=s[0].uv,t.sumPV=s[0].pv,t.sumPVUVPer=0===t.sumPV?0:t.sumPV/t.sumUV))})},queryPVUVChart:function(){this.drawChartDatas=[],this.drawChartDatas=this.pvuvList,this.drawOnlinePVUV()},addCompare:function(){this.compareForm=!0},compareSubmit:function(){var t=this,e=this.moment(this.compareDate).format("YYYY-MM-DD");return-1!==this.dataLegStr.indexOf(e)?(this.$message({message:"请选择不存在图表中的日期进行对比！",type:"warning"}),!1):this.moment(this.queryDate).format("YYYY-MM-DD")===e?(this.$message({message:"请选择不存在图表中的日期进行对比！",type:"warning"}),!1):(this.chartLoading=!0,void Object(i["f"])({compareDate:this.compareDate,platFormId:this.tApp.id}).then(function(e){var a=e.businessCode,s=e.resultSet;t.chartLoading=!1,t.compareForm=!1,"success"!==a?t.$message({message:"加载对比数据失败，请联系管理员！",type:"error"}):(t.compareList=s,t.compareUserChart())}))},compareUserChart:function(){this.drawChartDatas=this.pvuvList.concat(this.compareList),this.drawOnlinePVUV()},handleExport:function(){var t=this;if(0===this.pvuvList.length)return this.$message({message:"表格无数据，导出异常！",type:"warning"}),!1;Promise.all([a.e("chunk-61154d27"),a.e("chunk-0156a942")]).then(function(){var e=a("39a0"),s=e.exportExcel,r=["日期","小时","PV","UV","UV/PV占比"],i=["day","hour","pv","uv","PVUVPrec"],o=t.pvuvList,n=t.formatJson(i,o);s(r,n,"实时PVUVexcel")}.bind(null,a)).catch(a.oe)},formatJson:function(t,e){return e.map(function(e){return t.map(function(t){return e[t]})})},drawOnlinePVUV:function(){this.dataY={},this.dataYSer=[],this.dataLegStr=[],this.dataX=[];var t=[];for(var e in this.drawChartDatas){var a=this.drawChartDatas[e].day,s=this.drawChartDatas[e].hour,r=this.drawChartDatas[e].uv,i=this.drawChartDatas[e].pv;-1===t.indexOf(a)&&(t.push(a),this.dataLegStr.push(a+"_UV"),this.dataLegStr.push(a+"_PV")),-1===this.dataX.indexOf(s)&&this.dataX.push(s),null==this.dataY[a+"_UV"]&&(this.dataY[a+"_UV"]=[]),null==this.dataY[a+"_PV"]&&(this.dataY[a+"_PV"]=[]),this.dataY[a+"_UV"].push(r),this.dataY[a+"_PV"].push(i)}var o=0;for(var n in this.dataY){var l={},c=this.dataLegStr[o++];l["name"]=c;var d=c.split("_")[0];l["type"]="bar",l["data"]=this.dataY[n],l["barMaxWidth"]=80,l["stack"]=d+"PV/UV",this.dataYSer.push(l)}this.showCharts(this.dataLegStr,this.dataX,this.dataYSer)},showCharts:function(t,e,a){var s={border:!1,tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"5%",bottom:"5%",containLabel:!0},legend:{orient:"vertical",left:"center",bottom:"bottom",data:t},xAxis:{type:"category",name:"小时",data:e},yAxis:{type:"value",name:"PV/UV"},series:a};this.chartColumn=n.a.init(document.getElementById("onlinePVUVDiv")),this.chartColumn.clear(),this.chartColumn.setOption(s),window.onresize=this.chartColumn.resize}},created:function(){this.tApp=JSON.parse(sessionStorage.getItem("tApp")),this.getPVUVList()},mounted:function(){},updated:function(){}},c=l,d=(a("a840"),a("0cb2"),a("2877")),h=Object(d["a"])(c,s,r,!1,null,"66ea41ce",null);e["default"]=h.exports},"5e8c":function(t,e,a){},a840:function(t,e,a){"use strict";var s=a("5e8c"),r=a.n(s);r.a}}]);