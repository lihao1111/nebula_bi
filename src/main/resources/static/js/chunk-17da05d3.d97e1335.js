(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-17da05d3"],{"23e9":function(t,e,a){},2596:function(t,e,a){"use strict";var r=a("cb40"),i=a.n(r);i.a},"7f7f":function(t,e,a){var r=a("86cc").f,i=Function.prototype,n=/^\s*function ([^ (]*)/,s="name";s in i||a("9e1e")&&r(i,s,{configurable:!0,get:function(){try{return(""+this).match(n)[1]}catch(t){return""}}})},cb40:function(t,e,a){},d752:function(t,e,a){"use strict";var r=a("23e9"),i=a.n(r);i.a},f4f6:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"chart-container"},[a("el-col",{staticClass:"toolbar1",staticStyle:{height:"50px","padding-left":"10px","padding-top":"5px"},attrs:{span:24}},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",[a("div",{staticClass:"block"},[a("el-date-picker",{attrs:{size:"small",type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.queryDate,callback:function(e){t.queryDate=e},expression:"queryDate"}})],1)]),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:t.getOnlineOrder}},[t._v("查询")])],1),a("el-form-item",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:t.addCompare}},[t._v("对比日期")])],1)],1)],1),a("el-col",{attrs:{span:24}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.chartLoading,expression:"chartLoading"}],staticStyle:{width:"100%",height:"400px"},attrs:{id:"onlineOrderDiv"}})]),a("div",{staticStyle:{padding:"0px 10px"}},[a("el-col",{staticStyle:{"margin-top":"10px",height:"40px","line-height":"40px","background-color":"rgba(17, 146, 175, 0.18)"},attrs:{span:24}},[a("span",{staticStyle:{padding:"10px",color:"#606266"}},[t._v("详细数据"),a("i",{staticClass:"el-icon-info"})]),a("el-link",{staticStyle:{float:"right","margin-right":"10px","font-weight":"bold"},attrs:{type:"primary",underline:!1,icon:"el-icon-download"},on:{click:t.handleExport}},[t._v("\n        导出数据\n      ")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tOrderList,"highlight-current-row":"","header-cell-style":{"background-color":"#f2f2f2",color:"#3a8ee6","border-bottom":"1px #f2f2f2 solid"}}},[a("el-table-column",{attrs:{prop:"day",label:"日期",align:"center"}}),a("el-table-column",{attrs:{prop:"hour",label:"小时",align:"center"}}),a("el-table-column",{attrs:{prop:"online_num",sortable:"",label:"在线订购",align:"center"}})],1)],1),a("el-dialog",{attrs:{title:"选择",visible:t.compareForm,"close-on-click-modal":!1,width:"30%"},on:{"update:visible":function(e){t.compareForm=e}}},[a("div",{staticStyle:{"padding-left":"60px"}},[a("span",{staticStyle:{"font-size":"16px","font-weight":"bold","margin-right":"10px"}},[t._v("对比日期")]),a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.compareDate,callback:function(e){t.compareDate=e},expression:"compareDate"}})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){t.compareForm=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.compareSubmit()}}},[t._v("提交")])],1)])],1)},i=[],n=(a("7f7f"),a("4ec3")),s=a("313e"),o=a.n(s),c={data:function(){return{chartLoading:!1,queryDate:new Date,tApp:"",orderList:[],tOrderList:[],compareDate:new Date((new Date).getTime()-864e5),compareForm:!1,compareList:[],drawChartDatas:[],dataLegStr:[],dataX:[],dataYSer:[],dataY:{},chart:""}},methods:{getOnlineOrder:function(){var t=this;if(!this.queryDate)return this.$message({showClose:!0,message:"请选择查询日期！",type:"error"}),!1;this.chartLoading=!0,Object(n["A"])({queryDate:this.queryDate,platFormId:this.tApp.id}).then(function(e){var a=e.businessCode,r=e.resultSet;if(t.chartLoading=!1,"unauthenticated"===a)return t.$message({message:"未授权，请联系管理员！",type:"error"}),!1;"success"!==a?t.$message({message:"在线订购数据加载失败，请联系管理员！",type:"error"}):(t.orderList=r,t.tOrderList=[],t.orderList.forEach(function(e){var a=t.moment(t.queryDate).format("YYYY-MM-DD");e.day===a&&t.tOrderList.push(e)}),t.queryOrderChart())})},queryOrderChart:function(){this.drawChartDatas=[],this.drawChartDatas=this.orderList,this.drawOnlineOrder()},addCompare:function(){this.compareForm=!0},compareSubmit:function(){var t=this,e=this.moment(this.compareDate).format("YYYY-MM-DD");if(-1!==this.dataLegStr.indexOf(e))return this.$message({showClose:!0,message:"请选择不存在图表中的日期进行对比！",type:"warning"}),!1;this.chartLoading=!0,Object(n["e"])({compareDate:this.compareDate,platFormId:this.tApp.id}).then(function(e){var a=e.businessCode,r=e.resultSet;t.chartLoading=!1,t.compareForm=!1,"success"!==a?t.$message({message:"加载对比数据失败，请联系管理员！",type:"error"}):(t.compareList=r,t.compareOrderChart())})},compareOrderChart:function(){this.drawChartDatas=this.drawChartDatas.concat(this.compareList),this.drawOnlineOrder()},handleExport:function(){var t=this;if(0===this.tOrderList.length)return this.$message({message:"表格无数据，导出异常！",type:"warning"}),!1;Promise.all([a.e("chunk-61154d27"),a.e("chunk-2d0ba6db")]).then(function(){var e=a("39a0"),r=e.exportExcel,i=["日期","小时","实时订购"],n=["day","hour","online_num"],s=t.tOrderList,o=t.formatJson(n,s);r(i,o,"实时订购excel")}.bind(null,a)).catch(a.oe)},formatJson:function(t,e){return e.map(function(e){return t.map(function(t){return e[t]})})},drawOnlineOrder:function(){for(var t in this.dataY={},this.dataYSer=[],this.dataLegStr=[],this.dataX=[],this.drawChartDatas){var e=this.drawChartDatas[t].day,a=this.drawChartDatas[t].hour,r=this.drawChartDatas[t].online_num;-1===this.dataLegStr.indexOf(e)&&this.dataLegStr.push(e),-1===this.dataX.indexOf(a)&&this.dataX.push(a),null==this.dataY[e]&&(this.dataY[e]=[]),this.dataY[e].push(r)}var i=0;for(var n in this.dataY){var s={};s["name"]=this.dataLegStr[i++],s["type"]="line",s["data"]=this.dataY[n],s["smooth"]=!0,this.dataYSer.push(s)}this.showCharts(this.dataLegStr,this.dataX,this.dataYSer)},showCharts:function(t,e,a){var r={border:!1,tooltip:{trigger:"axis"},legend:{orient:"vertical",left:"center",bottom:"bottom",data:t},grid:{left:"3%",right:"5%",bottom:"10%",containLabel:!0},xAxis:{type:"category",name:"小时",data:e,axisTick:{alignWithLabel:!0}},yAxis:{type:"value",name:"在线订购数"},series:a};this.chart=o.a.init(document.getElementById("onlineOrderDiv")),this.chart.clear(),this.chart.setOption(r),window.onresize=this.chart.resize}},watch:{chart:function(){var t=this;this.chart.on("legendselectchanged",function(e){var a=e.name;if(t.dataLegStr.indexOf(a)<=2&&t.dataLegStr.indexOf(a)>=0)return!1;t.drawChartDatas=t.drawChartDatas.filter(function(t){return t["day"]!==a}),t.dataLegStr.splice(t.dataLegStr.indexOf(a,1)),t.dataYSer=t.dataYSer.filter(function(t){return t["name"]!==a}),t.showCharts(t.dataLegStr,t.dataX,t.dataYSer)})}},created:function(){this.tApp=JSON.parse(sessionStorage.getItem("tApp")),this.getOnlineOrder()},mounted:function(){},updated:function(){}},d=c,l=(a("2596"),a("d752"),a("2877")),h=Object(l["a"])(d,r,i,!1,null,"74939a47",null);e["default"]=h.exports}}]);